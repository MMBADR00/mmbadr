<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CortexLab | Project</title>
  <meta name="description" content="CortexLab project page: tools overview, icons, descriptions, and password-gated download." />
  <link rel="stylesheet" href="../style.css" />

  <script>
    document.documentElement.classList.add("js");
  </script>
</head>

<body>
  <nav class="topnav" aria-label="Primary navigation">
    <div class="container nav-inner">
      <div class="nav-links" aria-label="Navigation">
        <a href="../index.html#projects">Back to Projects</a>
        <a href="#overview">Overview</a>
        <a href="#tools">Tools</a>
        <a href="#download">Download</a>
      </div>
    </div>
  </nav>

  <header class="site-header">
    <div class="bg-grid" aria-hidden="true"></div>
    <div class="bg-scanline" aria-hidden="true"></div>

    <div class="container header-wrap">
      <div class="hero">
        <div class="hero-left reveal">
          <div class="badge-row">
            <span class="badge">Battery Analytics</span>
            <span class="badge badge-2">SOC and SOH</span>
            <span class="badge badge-3">Machine Learning</span>
            <span class="badge badge-4">PySide6 Desktop</span>
          </div>

          <h1 class="hero-title">CortexLab</h1>
          <p class="hero-subtitle">Integrated tools for battery workflows and estimation tasks</p>

          <div class="profile-links" aria-label="Project links">
            <a class="plink" href="../index.html#contact">Contact</a>
            <a class="plink" href="../index.html#projects">Projects</a>
            <a class="plink" href="#download">Download</a>
          </div>
        </div>
      </div>

      <div class="header-divider" aria-hidden="true"></div>
    </div>
  </header>

  <main class="container main">
    <section id="overview" class="section reveal">
      <div class="section-head"><h2>Overview</h2></div>
      <div class="card">
        <p class="muted">
          CortexLab groups multiple battery engineering tools into one consistent desktop experience.
          It focuses on data loading, signal visualization, battery KPI computation, OCV-SOC workflows,
          offline SOC and SOH estimation, real-time monitoring integration, and ML-based prediction.
        </p>

        <div class="spacer"></div>

        <div class="project-hero">
          <img
            class="project-hero-img"
            src="../assets/projects/cortexlab.png"
            alt="CortexLab screenshot"
            loading="lazy"
          />
        </div>
      </div>
    </section>

    <section id="tools" class="section reveal">
      <div class="section-head"><h2>Tools</h2></div>
      <div class="card">
        <p class="muted">
          Each module below has an icon and a short description. Replace the icon paths with your real files.
        </p>

        <div class="spacer"></div>

        <div class="tool-grid" role="list">
          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/connection.png" alt="Connection Viewer icon" />
            <div class="tool-text">
              <div class="tool-title">Connection Viewer</div>
              <div class="tool-desc">Pin mapping, wiring guidance, sensor configuration, and connection validation screens.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/ocv.png" alt="OCV-SOC Analysis icon" />
            <div class="tool-text">
              <div class="tool-title">OCV-SOC Analysis</div>
              <div class="tool-desc">OCV curve handling, sorting, fitting, and SOC estimation support using OCV-based workflows.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/offline.png" alt="Offline State Estimation icon" />
            <div class="tool-text">
              <div class="tool-title">Offline State Estimation</div>
              <div class="tool-desc">Offline SOC and SOH estimation from CSV or Excel data with plotting and export.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/rt.png" alt="RT Monitoring icon" />
            <div class="tool-text">
              <div class="tool-title">RT Monitoring</div>
              <div class="tool-desc">Real-time acquisition and visualization for sensors, with estimation and logging support.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/kpi.png" alt="Battery KPIs icon" />
            <div class="tool-text">
              <div class="tool-title">Battery KPIs</div>
              <div class="tool-desc">Compute KPI metrics such as SOC, SOH-related indicators, and reporting summaries.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/drivecycle.png" alt="Drive Cycle icon" />
            <div class="tool-text">
              <div class="tool-title">Drive Cycle</div>
              <div class="tool-desc">Drive cycle loading, processing, slope and profile evaluation, and analysis plots.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/ml.png" alt="Machine Learning Prediction icon" />
            <div class="tool-text">
              <div class="tool-title">Machine Learning Prediction</div>
              <div class="tool-desc">Training and evaluation utilities for regression models used in estimation tasks.</div>
            </div>
          </div>

          <div class="tool-item" role="listitem">
            <img class="tool-icon" src="../assets/tools/docs.png" alt="Documentation Viewer icon" />
            <div class="tool-text">
              <div class="tool-title">Documentation Viewer</div>
              <div class="tool-desc">Built-in documentation pages and downloadable supplementary materials.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="download" class="section reveal">
      <div class="section-head"><h2>Download</h2></div>
      <div class="card">
        <p class="muted">
          Enter the password to unlock the download button.
          This check runs in the browser, so it is not secure access control for private files.
          For real protection, host downloads behind authenticated access.
        </p>

        <div class="spacer"></div>

        <div class="download-gate">
          <label class="gate-label" for="dl-pass">Password</label>
          <div class="gate-row">
            <input id="dl-pass" class="gate-input" type="password" placeholder="Enter password" autocomplete="current-password" />
            <button id="dl-unlock" class="btn" type="button">Unlock</button>
          </div>

          <p id="dl-msg" class="gate-msg muted" aria-live="polite"></p>

          <div class="spacer"></div>

          <!-- Locked by default: href is empty and button is disabled -->
          <a
            id="dl-link"
            class="btn btn-outline btn-disabled"
            href=""
            download
            aria-disabled="true"
          >
            Download CortexLab
          </a>
        </div>

        <div class="spacer"></div>

        <p class="muted" style="font-size: 13px;">
          Tip: Put your installer or zip inside <code>downloads/</code>, for example:
          <code>downloads/CortexLab.zip</code>.
        </p>
      </div>
    </section>

    <footer class="footer">
      <p>Â© <span id="year"></span> Mohamed M. Badr. Hosted on GitHub Pages.</p>
    </footer>
  </main>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // Reveal animation using IntersectionObserver
    (function () {
      const els = document.querySelectorAll(".reveal");
      if (!("IntersectionObserver" in window) || els.length === 0) {
        els.forEach((el) => el.classList.add("in"));
        return;
      }
      const obs = new IntersectionObserver((entries) => {
        entries.forEach((e) => {
          if (e.isIntersecting) {
            e.target.classList.add("in");
            obs.unobserve(e.target);
          }
        });
      }, { threshold: 0.12 });

      els.forEach((el, idx) => {
        el.style.setProperty("--reveal-delay", (idx * 60) + "ms");
        obs.observe(el);
      });
    })();

    // Password gate (UI gate only, not secure access control)
    // Replace this hash with the SHA-256 hash of your real password.
    // To generate: open DevTools Console and run:
    // crypto.subtle.digest("SHA-256", new TextEncoder().encode("YOUR_PASSWORD"))
    //   .then(b => [...new Uint8Array(b)].map(x => x.toString(16).padStart(2,"0")).join(""))
    const PASSWORD_SHA256_HEX = "REPLACE_WITH_YOUR_SHA256_HEX";
    const DOWNLOAD_URL = "../downloads/CortexLab.zip";  // Replace with your real file path

    const passEl = document.getElementById("dl-pass");
    const unlockBtn = document.getElementById("dl-unlock");
    const msgEl = document.getElementById("dl-msg");
    const linkEl = document.getElementById("dl-link");

    function setLocked(message) {
      msgEl.textContent = message || "";
      linkEl.href = "";
      linkEl.classList.add("btn-disabled");
      linkEl.setAttribute("aria-disabled", "true");
    }

    function setUnlocked(message) {
      msgEl.textContent = message || "";
      linkEl.href = DOWNLOAD_URL;
      linkEl.classList.remove("btn-disabled");
      linkEl.setAttribute("aria-disabled", "false");
    }

    async function sha256Hex(text) {
      const data = new TextEncoder().encode(text);
      const hashBuf = await crypto.subtle.digest("SHA-256", data);
      const hashArr = Array.from(new Uint8Array(hashBuf));
      return hashArr.map((b) => b.toString(16).padStart(2, "0")).join("");
    }

    unlockBtn.addEventListener("click", async () => {
      const pwd = (passEl.value || "").trim();
      if (!pwd) {
        setLocked("Please enter the password.");
        return;
      }

      try {
        const hex = await sha256Hex(pwd);
        if (hex === PASSWORD_SHA256_HEX) {
          setUnlocked("Unlocked. You can download CortexLab now.");
        } else {
          setLocked("Incorrect password. Download is still locked.");
        }
      } catch (err) {
        setLocked("Error verifying password in this browser.");
      }
    });

    // Prevent clicking the download link while locked
    linkEl.addEventListener("click", (e) => {
      if (linkEl.getAttribute("aria-disabled") === "true") {
        e.preventDefault();
      }
    });

    // Start locked
    setLocked("");
  </script>
</body>
</html>
